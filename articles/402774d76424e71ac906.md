---
title: "ESLint 設定を作成する技術"
emoji: "🛠"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [ESLint]
published: false
---

[ESLint](https://eslint.org/) は関連するパッケージが多く、また、活発に開発されていることもあり、設定するのに一苦労ということも多いツールです。そういった方向けに ESLint の設定を作るための基礎的な説明を書いてみました。

また、同時に ESLint 設定の逆引き集も公開しています。紹介している設定はすべて、ここで説明した知識があれば作れるものですが、時短したいという方は参照してください。

https://zenn.dev/januswel/articles/e17e4ff0657a9b137a59

## 設定ファイルの拡張子

設定用のファイルとしてプロジェクトのルートディレクトリーに `.eslintrc.yml` もしくは `.eslintrc.json` を作成しましょう。 ESLint は [`.eslintrc.*` もしくは `package.json` 内の `eslintConfig` 設定を読んでくれます](https://eslint.org/docs/user-guide/configuring/configuration-files#configuration-file-formats)が、一般的な開発用途であれば YAML もしくは JSON で事足りるからです。 YAML と JSON のどちらを選ぶかはお好みでどうぞ。

また、 `package.json` 内に設定を書くのは避けましょう。様々な理由で `package.json` は変更されるため、 Git 管理下において変更が ESLint に関連するものなのかどうかをファイル名から判別できないためです。

`.eslintrc.js` / `.eslintrc.cjs` は設定を動的に生成したいときに使用しますが、よほど特殊なことをしていない限り [`-c` / `--config` オプション](https://eslint.org/docs/user-guide/command-line-interface#-c-config)による設定ファイルの指定で事足りるはずです。

## 基礎となる設定

以降、設定は YAML で記載していきます。個人的にスッキリ書けると感じているからです。

まず、すべての基礎となる設定を書きましょう。

```yaml:.eslintrc.yml
---
root: true
extends:
  - eslint:recommended
```

`root` はプロジェクトのルートディレクトリーに置く設定ファイルに対して書くものです。 [ESLint は設定のカスケーディングを許可している](https://eslint.org/docs/user-guide/configuring/configuration-files#cascading-and-hierarchy)ため、これを書かないとトラブルに見舞われる可能性が高くなります。

`extends` は[設定を流用](https://eslint.org/docs/user-guide/configuring/configuration-files#extending-configuration-files)するためのものです。効果的に ESLint を設定する上で必須となっています。

### 設定のカスケーディング

次の構造を持つプロジェクトを考えます。

```
/
  .eslintrc.yml
  src/
    index.js
    lib/
      .eslintrc.yml
      util.js
```

この場合、 `util.js` のリンティングに適用される設定は `/.eslintrc.yml` と `/src/lib/.eslintrc.yml` をマージしたものが使用されます。同じ設定項目が両方にかかれている場合は `/src/lib/.eslintrc.yml` で指定した値が優先されます。

例として、それぞれのファイルが次の設定であるとしましょう。

```yaml:/.eslintrc.yml
root: true
extends:
  - eslint:recommended
rules:
  no-console: off
```

```yaml:/src/lib/.eslintrc.yml
rules:
  no-console: error
```

このとき、 `util.js` をリンティングする設定は次となります。

```yaml
root: true
extends:
  - eslint:recommended
rules:
  no-console: error
```

### `root` を設定しない場合

プロジェクトのルートディレクトリーに配置している設定ファイルに `root` を設定していない場合、環境によって設定が異なってしまう可能性があることに注意しましょう。

例えば次のそれぞれのディレクトリー構造で作業している場合、後者は `project-a` 内部のファイルへのリンティング時に `.eslintrc.json` の設定を適用してしまいます。これでは前者と後者で ESLint 実行結果が異なる可能性が出てしまいます。

```
/
  home/
    someone/
      project-a/
        .git/
        .eslintrc.yml
```

```
/
  Desktop/
    .eslintrc.json
    project-a/
      .git/
      .eslintrc.yml
```

### 設定の流用

`extends` はカスケーディングとは異なる方法で設定をマージする方法です。

主に各ツール用の推奨設定を利用するために使うものとなります。もちろん、自分でベースとなる設定を作り、それを流用するために使うことも可能です。

ESLint は標準で `eslint:recommended` と `eslint:all` という設定のプリセットを持っています。上述した基礎設定は `eslint:recommended` を利用している例となります。ちなみに [`eslint:all` のプロダクトへの利用は非推奨](https://eslint.org/docs/user-guide/configuring/configuration-files#using-eslintall)ですので注意しましょう。

### 設定集

`eslint-config-prettier` など、設定のみがまとめられたパッケージも存在します。 `eslint-config-` という接頭辞がついたものが該当します。世界中のエキスパートが考えた設定集と呼べるもので、扱いやすくまとまっています。

これらを使う際も `extends` に指定しますが、 [`eslint-config-` 部分は省略しても良い、というルール](https://eslint.org/docs/user-guide/configuring/configuration-files#extending-configuration-files)があります。もちろん、省略しなくとも構いません。

## プラグインを使う

実際の開発においては TypeScript や Prettier など、効率を上げるためのツールを使用するかと思います。その場合はそれぞれのツール向けの ESLint プラグインを利用しましょう。

よく使われるプラグインは README にインストールガイドが整備されており、それを読みながらインストールすることで特に問題なく使えるようになっています。英語が苦手な方でも機械翻訳などを活用すればわかる程度の文章量ですので、頑張ってみてください。

### 設定ファイル内でのプラグインの指定方法

プラグインは次のように、 `eslint-plugin-` という接頭辞がついていることが多いです。

- eslint-plugin-jest
- eslint-plugin-react
- etc

設定ファイル内の `plugins` に指定しますが、その際に `eslint-plugin-` を省略することが可能です。

```yaml:.eslintrc.yml
root: true
plugins:
  - jest
extends:
  - eslint:recommended
```

### プラグイン提供の設定集

プラグインは同時に、設定集を提供していることがあります。例えば `eslint-plugin-jest` では `recommended` 、 `all` 、 `style` の 3 つを提供しています。

これらを使う際は `extends` に指定する必要がありますが、その際の指定方法は独特です。大きく 2 段階に分かれます。

1. プラグインの指定
2. プラグイン内の設定集の指定

`extends` 内でプラグインを指定するためには `plugin:` という接頭辞をつける必要があります。この際、プラグイン名が `eslint-plugin-` ではじまるものであれば、 `eslint-plugin-` は省略可能です。

さらに、プラグインの指定に続けて `/` と設定集の名前を書きます。 `eslint-plugin-jest` が持つ `recommended` という設定であれば `plugin:jest/recommended` となります。

## `extends` の指定方法まとめ

`extends` の指定は様々なルールがありますので、表にまとめました。

分類                    | 分類の例                            | 指定方法                                            | 指定方法の例
------------------------|-------------------------------------|-----------------------------------------------------|---
プリセット              | `eslint:recommended` / `eslint:all` | そのまま書く                                        | `eslint:recommended`
ファイルパス            | `~/mybesteslintrc.yml` など         | そのまま書く                                        | `~/mybesteslintrc.yml`
パッケージ              | `@yourname/eslintrc` など           | そのまま書く                                        | `@yourname/eslintrc`
設定集                  | `eslint-config-prettier` など       | `eslint-config-` を省略して書く                     | `prettier`
プラグイン提供の設定集  | `eslint-plugin-react` など          | `eslint-plugin-` を省略し `plugin:` を接頭辞につけ、 `/` に続けて設定名を書く | `plugin:react/recommended`

## `extends` の指定順

各プラグインや設定集のインストールガイドに書いてありますので、それを遵守していればおかしな挙動をすることはないはずです。

ただ、 `extends` に指定した配列の上から評価され、同一の設定項目は下にあるもので上書きされていくことには注意してください。 `eslint:recommended` をまず有効にし、 TypeScript など開発全体に関わるものを上の方に、 Jest など特定ファイルに対するものを下の方に書く、という順序を意識すると設定も読みやすくなります。

## 最後に

ここまでで説明した知識があれば自分好みの設定ファイルを作成できるようになります。

実際の例をみたい場合は[ESLint 設定逆引き集](https://zenn.dev/januswel/articles/e17e4ff0657a9b137a59)を参照してみてください。
